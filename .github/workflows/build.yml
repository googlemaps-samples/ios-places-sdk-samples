
# Copyright 2024 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

name: Build Samples

on:
    push:
        branches: [ '*' ]
    pull_request:
        branches: [ '*' ]
    repository_dispatch:
        types: [ build ]
    schedule:
        - cron: '0 22 * * *'
    workflow_dispatch:

jobs:
    build-GooglePlacesDemos:
        runs-on: macos-latest

        steps:
        - name: Checkout repository
          uses: actions/checkout@v4

        - name: Set Xcode version
          uses: maxim-lobanov/setup-xcode@v1
          with:
            xcode-version: latest-stable

        - name: Build and Test (ï£¿ iOS 18.4)
          run: |
            set -o pipefail
            echo "Adding empty GooglePlacesDemos.xcconfig file"
            touch GooglePlacesDemos/GooglePlacesDemos/GooglePlacesDemos.xcconfig

            echo "Building and Testing"
            xcodebuild test -project GooglePlacesDemos/GooglePlacesDemos.xcodeproj \
            -scheme GooglePlacesDemos \
            -destination 'platform=iOS Simulator,OS=18.4,name=iPhone 16' | xcpretty

    test: # used as required status check
      runs-on: ubuntu-latest
      needs:
        - build-GooglePlacesDemos
      steps:
        - run: echo "Fail if all other steps are not successful"
